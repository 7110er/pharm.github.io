<!DOCTYPE html>
<html lang="zh-TW">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="高順鴻">
        <title>衛教專區</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <!-- Rwd js -->
        <!-- <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
        <script src="https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js"></script> -->

        <!-- Rwd css -->
        <!-- <link rel="stylesheet"  href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css">
        <link rel="stylesheet"  href="https://cdn.datatables.net/responsive/2.2.9/css/responsive.dataTables.min.css"> -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">       
        <style>
            body {margin:0;font-family:Arial}

            .navbar {
            overflow: hidden;
            background-color: #040357; 
            width: 100%;
            }

            .navbar a {
            float: right;
            font-size: 16px;
            color: white;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
            overflow: auto;
            display: block;

            }

            .subnav {
            float: left;
            overflow: auto;
            max-width: 80%;
            }

            .subnav .subnavbtn {
            font-size: 14px;  
            border: none;
            outline: none;
            color: white;
            padding: 14px 16px;
            background-color:#040357;
            font-family: inherit;
            margin: 0;
            font-weight: bolder;
            overflow: auto;
            }

            .navbar a:hover, .subnav:hover .subnavbtn {
            background-color: rgb(1, 0, 2);
            }

            .subnav-content {
            display: none;
            position: absolute;
            right: 0;
            background-color: #b5c7f7;
            width: 100%;
            z-index: 1;
            }

            .subnav-content a {
            float: left;
            color: rgb(12, 0, 63);
            text-decoration: none;

            }

            .subnav-content a:hover {
            background-color: #eee;
            color: black;
            }

            .subnav:hover .subnav-content {
            display: block;
            }      
            /* The sticky class is added to the navbar with JS when it reaches its scroll position */
            .sticky {
            position: fixed;
            top: 0;
            width: 100%;
            }

            /* Add some top padding to the page content to prevent sudden quick movement (as the navigation bar gets a new position at the top of the page (position:fixed and top:0) */
            .sticky + .content {
            padding-top: 60px;
}
        </style>           
        <script >

            function ref(){
                parent.location.reload();
                console.log('123');
            }
            function searchGoogleSheet(divElement){
                var searchText = $(divElement).text();
                google.script.run.withSuccessHandler(createTable).search(searchText);
                console.log('123');
            }
            function createTable(dataArray) {
            if (dataArray && dataArray !== undefined && dataArray.length != 0) {

                var result1 = "<table class='table table-sm table-striped' id='dtable' style='font-size:16px'>" +
                    "<thead style='white-space: normal'>" +

                    "<tr>" 
                    for (var i = 0; i < dataArray.length; i++) {
                        for (var j = 0; j < 1; j++) {
                            if(dataArray[i][j]==''){
                                result1+='';
                            }
                            else{
                                result1 +="<th scope='col' style='width:90px' >中文名</th>"+"<td >" + dataArray[i][j] + "</td>";
                            }
                    }
                }
                    result1+=
                    "</tr>" + 
                    "<tr>" + 
                    "<th scope='col' style='width:90px '>英文名</th>" 
                    for (var i = 0; i < dataArray.length; i++) {
                        for (var j = 1; j < 2; j++) {
                        result1 += "<td>" + dataArray[i][j] + "</td>";
                    }
                }
                    result1+=
                    "</tr>" + 
                    "<tr>" + 
                    "<th scope='col'style='width:90px'>主成分</th>" 
                    for (var i = 0; i < dataArray.length; i++) {
                        for (var j = 2; j < 3; j++) {
                        result1 += "<td>" + dataArray[i][j] + "</td>";
                    }
                }
                    result1+=
                    "</tr>" + 
                    "<tr>" 
                    for (var i = 0; i < dataArray.length; i++) {
                        for (var j = 3; j < 4; j++) {
                            if(dataArray[i][j]==''){
                                result1+='';
                            }
                            else{
                                result1 +="<th scope='col' style='width:90px' >適應症</th>"+"<td >" +  dataArray[i][j] + "</td>";
                            }
                    }
                }
                    result1+=
                    "</tr>" +
                    "<tr>"
                    for (var i = 0; i < dataArray.length; i++) {
                        for (var j = 4; j < 5; j++) {
                            if (isURL(dataArray[i][j])){
                                result1 += "<td colspan='2'  ><img src='"+ dataArray[i][j] + "'  style='width:100%'></td>"
                            }
                            else{
                                result1 += "";
                            }
                    }
                }
                    result1+=
                    "</tr>"+
                    "<tr>"
                    for (var i = 0; i < dataArray.length; i++) {
                        for (var j = 5 ;j < 6; j++) {
                            if (isURL(dataArray[i][j])){
                            result1 += "<td colspan='2'  ><img src='"+ dataArray[i][j] + "'  style='width:100%'></td>"
                        }
                        else{
                            result1 += "";
                        }
                    }
                }
                    result1+=
                    "</tr>"+
                    "<tr>"
                    for (var i = 0; i < dataArray.length; i++) {
                        for (var j = 6 ;j < 7; j++) {
                            if (isURL(dataArray[i][j])){
                            result1 += "<td colspan='2'  ><img src='"+ dataArray[i][j] + "'  style='width:100%'></td>"
                        }
                        else{
                            result1 += "";
                        }
                    }
                }
                    result1+=
                    "</tr>"+

                    "</thead>"+
                    "</table>";
                
                

                var div = document.getElementById('result');
                div.innerHTML = result1;
                
            } 

            else {

                var div = document.getElementById('result');
                div.innerHTML = "沒有找到相關藥物，請重新輸入。";
            }
        }
                // 判斷string 是否為網址
            function isURL(string) {
                let url;
                
                try {
                    url = new URL(string);
                } catch (_) {
                    return false;  
                }

                return url.protocol === "http:" || url.protocol === "https:";
            }

        </script>
    </head>
    <body>
        <a href="" onclick="ref()" ><img src="https://i.imgur.com/odckQBS.png" style="width: 20%; float: left;" ></a>
        <div class="navbar" id="navbar">
            <div class="subnav">
              <button class="subnavbtn">心血管內科 <i class="fa fa-caret-down"></i></button>
              <div class="subnav-content">
                <a href="#" onclick="searchGoogleSheet(this)">高血壓</a>
                <a href="#" onclick="searchGoogleSheet(this)">心衰竭</a>
                <a href="#" onclick="searchGoogleSheet(this)">冠心症</a>
                <a href="#" onclick="searchGoogleSheet(this)">心律不整</a>

            </div>
            </div> 
            <div class="subnav">
              <button class="subnavbtn">內分泌科 <i class="fa fa-caret-down"></i></button>
              <div class="subnav-content">
                <a href="#" onclick="searchGoogleSheet(this)">糖尿病</a>
                <a href="#" onclick="searchGoogleSheet(this)">甲狀腺疾病</a>
                <a href="#" onclick="searchGoogleSheet(this)">代謝症候群</a>
              </div>
            </div> 
            <div class="subnav">
              <button class="subnavbtn">神經科 <i class="fa fa-caret-down"></i></button>
              <div class="subnav-content">
                <a href="#" onclick="searchGoogleSheet(this)">中風</a>
                <a href="#" onclick="searchGoogleSheet(this)">失智症</a>
                <a href="#" onclick="searchGoogleSheet(this)">帕金森氏症</a>
              </div>
            </div>
            <div class="subnav">
                <button class="subnavbtn">腎臟科 <i class="fa fa-caret-down"></i></button>
                <div class="subnav-content">
                  <a href="#" onclick="searchGoogleSheet(this)">慢性腎臟病</a>
                  <a href="#" onclick="searchGoogleSheet(this)">貧血</a>
                  <a href="#" onclick="searchGoogleSheet(this)">血液透析</a>
                </div>
              </div>
              <div class="subnav">
                <button class="subnavbtn">胸腔科 <i class="fa fa-caret-down"></i></button>
                <div class="subnav-content">
                  <a href="#" onclick="searchGoogleSheet(this)">氣喘</a>
                  <a href="#" onclick="searchGoogleSheet(this)">慢性阻塞性肺病</a>
                </div>
              </div>
              <div class="subnav">
                <button class="subnavbtn">肝膽腸胃科 <i class="fa fa-caret-down"></i></button>
                <div class="subnav-content">
                  <a href="#" onclick="searchGoogleSheet(this)">慢性肝炎</a>
                  <a href="#" onclick="searchGoogleSheet(this)">胃食道逆流</a>
                  <a href="#" onclick="searchGoogleSheet(this)">消化性潰瘍</a>
                </div>
              </div>
              <div class="subnav">
                <button class="subnavbtn">風濕免疫科 <i class="fa fa-caret-down"></i></button>
                <div class="subnav-content">
                  <a href="#" onclick="searchGoogleSheet(this)">痛風</a>
                  <a href="#" onclick="searchGoogleSheet(this)">類風溼關節炎</a>
                  <a href="#" onclick="searchGoogleSheet(this)">紅斑性狼瘡</a>
                </div>
              </div>
              <div class="subnav">
                <button class="subnavbtn">感染科 <i class="fa fa-caret-down"></i></button>
                <div class="subnav-content">
                  <a href="#" onclick="searchGoogleSheet(this)">愛滋病</a>
                  <a href="#" onclick="searchGoogleSheet(this)">肺結核</a>
                  <a href="#" onclick="searchGoogleSheet(this)">疫苗相關</a>
                </div>
              </div>
        </div>        
        <br>
        <div id="result">
            
        </div>
        <script>
            window.onscroll = function() {myFunction()};

            var navbar = document.getElementById("navbar");
            var sticky = navbar.offsetTop;

            function myFunction() {
                if (window.pageYOffset >= sticky) {
                    navbar.classList.add("sticky")
                } else {
                    navbar.classList.remove("sticky");
                }
            }
        </script>    
    </body>
</html>