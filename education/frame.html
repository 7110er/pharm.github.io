<!DOCTYPE html>
<html lang="zh-TW">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="高順鴻">
        <title>衛教專區</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">       
        <style>
            body {
                font-family: Arial, Helvetica, sans-serif;
                margin: 0;
            }
            .home {
                width: 20%;
                height: 10%;
                position: fixed;
                color: rgb(230, 84, 84);
                background-color: #012061;
            }
            .homeBtn{
                font-size: large;
                color: white;
                text-align: center;
                
                
            }
            .navbar {
                list-style-type: none;
                margin: 5% 0;
                padding: 0;
                width: 20%;
                background-color: #052449;
                position: fixed;
                height: 100%;
                overflow: auto;
            }

            .navbar a {
            display : block;
            font-size: 14px;
            color: white;
            text-align: left;
            padding: 14px 5px;
            text-decoration: none;
            }

            .subnav {
            overflow: hidden;
            }
            .subnav .subnavbtn {
            font-size: 12px;  
            border: none;
            outline: none;
            color: white;
            padding: 14px 5px;
            background-color: inherit;
            font-family: inherit;
            margin: 0;
            }
            .subnav-content {
            display: none;
            position: relative;
            left: 0;
            background-color: rgb(192, 211, 252);
            z-index: 1;
            }
            .subnav-content a {
            display: block;
            color: rgb(0, 0, 0);
            text-decoration: none;
            }
            .subnav-content a:hover {
            background-color: #eee;
            color: black;
            }
            .change {
            display: block;
            }
            .sticky {
            position: fixed;
            top: 0;
            margin-left: 20%;
            width: 80%;
            background-color: #ceddf0;
            color: rgb(0, 0, 0);
            }
            /* .sticky + .content {
            padding-top: 60px;
            margin-left: 20%;
            } */
        </style>
        <script >

            function ref(){
                parent.location.reload();
                console.log('123');
            }
            function searchGoogleSheet(divElement){
                var searchText = $(divElement).text();
                google.script.run.withSuccessHandler(createTable).search(searchText);
                console.log('123');
            }
            function createTable(dataArray) {
            if (dataArray && dataArray !== undefined && dataArray.length != 0) {

                var result1 = "<table class='table table-sm table-striped' id='dtable' style='font-size:16px'>" +
                    "<thead style='white-space: normal'>" +

                    "<tr>" 
                    for (var i = 0; i < dataArray.length; i++) {
                        for (var j = 0; j < 1; j++) {
                            if(dataArray[i][j]==''){
                                result1+='';
                            }
                            else{
                                result1 +="<th scope='col' style='width:90px' >中文名</th>"+"<td >" + dataArray[i][j] + "</td>";
                            }
                    }
                }
                    result1+=
                    "</tr>" + 
                    "<tr>" + 
                    "<th scope='col' style='width:90px '>英文名</th>" 
                    for (var i = 0; i < dataArray.length; i++) {
                        for (var j = 1; j < 2; j++) {
                        result1 += "<td>" + dataArray[i][j] + "</td>";
                    }
                }
                    result1+=
                    "</tr>" + 
                    "<tr>" + 
                    "<th scope='col'style='width:90px'>主成分</th>" 
                    for (var i = 0; i < dataArray.length; i++) {
                        for (var j = 2; j < 3; j++) {
                        result1 += "<td>" + dataArray[i][j] + "</td>";
                    }
                }
                    result1+=
                    "</tr>" + 
                    "<tr>" 
                    for (var i = 0; i < dataArray.length; i++) {
                        for (var j = 3; j < 4; j++) {
                            if(dataArray[i][j]==''){
                                result1+='';
                            }
                            else{
                                result1 +="<th scope='col' style='width:90px' >適應症</th>"+"<td >" +  dataArray[i][j] + "</td>";
                            }
                    }
                }
                    result1+=
                    "</tr>" +
                    "<tr>"
                    for (var i = 0; i < dataArray.length; i++) {
                        for (var j = 4; j < 5; j++) {
                            if (isURL(dataArray[i][j])){
                                result1 += "<td colspan='2'  ><img src='"+ dataArray[i][j] + "'  style='width:100%'></td>"
                            }
                            else{
                                result1 += "";
                            }
                    }
                }
                    result1+=
                    "</tr>"+
                    "<tr>"
                    for (var i = 0; i < dataArray.length; i++) {
                        for (var j = 5 ;j < 6; j++) {
                            if (isURL(dataArray[i][j])){
                            result1 += "<td colspan='2'  ><img src='"+ dataArray[i][j] + "'  style='width:100%'></td>"
                        }
                        else{
                            result1 += "";
                        }
                    }
                }
                    result1+=
                    "</tr>"+
                    "<tr>"
                    for (var i = 0; i < dataArray.length; i++) {
                        for (var j = 6 ;j < 7; j++) {
                            if (isURL(dataArray[i][j])){
                            result1 += "<td colspan='2'  ><img src='"+ dataArray[i][j] + "'  style='width:100%'></td>"
                        }
                        else{
                            result1 += "";
                        }
                    }
                }
                    result1+=
                    "</tr>"+

                    "</thead>"+
                    "</table>";
                
                

                var div = document.getElementById('result');
                div.innerHTML = result1;
                
            } 

            else {

                var div = document.getElementById('result');
                div.innerHTML = "沒有找到相關藥物，請重新輸入。";
            }
        }
                // 判斷string 是否為網址
            function isURL(string) {
                let url;
                
                try {
                    url = new URL(string);
                } catch (_) {
                    return false;  
                }

                return url.protocol === "http:" || url.protocol === "https:";
            }

        </script>
    </head>
    <body >
        <div class="home">
            <a class="homeBtn" href="#">桃醫藥師門診</a>
        </div>
        <div class="navbar" id="navbar">
            <div class="subnav">
              <button class="subnavbtn" onclick="change(this)">心血管內科 <i class="fa fa-caret-down"></i></button>
              <div class="subnav-content">
                <a href="#" onclick="searchGoogleSheet(this)">高血壓</a>
                <a href="#" onclick="searchGoogleSheet(this)">心衰竭</a>
                <a href="#" onclick="searchGoogleSheet(this)">冠心症</a>
                <a href="#" onclick="searchGoogleSheet(this)">心律不整</a>

            </div>
            </div> 
            <div class="subnav">
              <button class="subnavbtn" onclick="change(this)">內分泌科 <i class="fa fa-caret-down"></i></button>
              <div class="subnav-content">
                <a href="#" onclick="searchGoogleSheet(this)">糖尿病</a>
                <a href="#" onclick="searchGoogleSheet(this)">甲狀腺疾病</a>
                <a href="#" onclick="searchGoogleSheet(this)">代謝症候群</a>
              </div>
            </div> 
            <div class="subnav">
              <button class="subnavbtn" onclick="change(this)">神經科 <i class="fa fa-caret-down"></i></button>
              <div class="subnav-content">
                <a href="#" onclick="searchGoogleSheet(this)">中風</a>
                <a href="#" onclick="searchGoogleSheet(this)">失智症</a>
                <a href="#" onclick="searchGoogleSheet(this)">帕金森氏症</a>
              </div>
            </div>
            <div class="subnav">
                <button class="subnavbtn" onclick="change(this)">腎臟科 <i class="fa fa-caret-down"></i></button>
                <div class="subnav-content">
                  <a href="#" onclick="searchGoogleSheet(this)">慢性腎臟病</a>
                  <a href="#" onclick="searchGoogleSheet(this)">貧血</a>
                  <a href="#" onclick="searchGoogleSheet(this)">血液透析</a>
                </div>
              </div>
              <div class="subnav">
                <button class="subnavbtn" onclick="change(this)">胸腔科 <i class="fa fa-caret-down"></i></button>
                <div class="subnav-content">
                  <a href="#" onclick="searchGoogleSheet(this)">氣喘</a>
                  <a href="#" onclick="searchGoogleSheet(this)">慢性阻塞性肺病</a>
                </div>
              </div>
              <div class="subnav">
                <button class="subnavbtn" onclick="change(this)">肝膽腸胃科 <i class="fa fa-caret-down"></i></button>
                <div class="subnav-content">
                  <a href="#" onclick="searchGoogleSheet(this)">慢性肝炎</a>
                  <a href="#" onclick="searchGoogleSheet(this)">胃食道逆流</a>
                  <a href="#" onclick="searchGoogleSheet(this)">消化性潰瘍</a>
                </div>
              </div>
              <div class="subnav">
                <button class="subnavbtn" onclick="change(this)">風濕免疫科 <i class="fa fa-caret-down"></i></button>
                <div class="subnav-content">
                  <a href="#" onclick="searchGoogleSheet(this)">痛風</a>
                  <a href="#" onclick="searchGoogleSheet(this)">類風溼關節炎</a>
                  <a href="#" onclick="searchGoogleSheet(this)">紅斑性狼瘡</a>
                </div>
              </div>
              <div class="subnav">
                <button class="subnavbtn" onclick="change(this)">感染科 <i class="fa fa-caret-down"></i></button>
                <div class="subnav-content">
                  <a href="#" onclick="searchGoogleSheet(this)">愛滋病</a>
                  <a href="#" onclick="searchGoogleSheet(this)">肺結核</a>
                  <a href="#" onclick="searchGoogleSheet(this)">疫苗相關</a>
                </div>
              </div>
        </div>
        <div>
            <div id="upNav" class="sticky">
                <ul class="nav navbar-nav" >
                <li><a href="#section1" >Section 1</a></li>
                <li><a href="#section2">Section 2</a></li>
                <li><a href="#section3">Section 3</a></li>
                </ul>
            </div>
        
            <div id="result" style="margin-left:20%;padding:5% 1px ;">
                <div id="section1" class="container-fluid">
                    <h1>Section 1</h1>
                    <p>Try to scroll this section and look at the navigation bar while scrolling! Try to scroll this section and look at the navigation bar while scrolling!</p>
                    <p>Try to scroll this section and look at the navigation bar while scrolling! Try to scroll this section and look at the navigation bar while scrolling!</p>
                </div>
                <div id="section2" class="container-fluid">
                    <h1>Section 2</h1>
                    <p><img src="https://i.imgur.com/UX64sfI.jpg"></p>
                    <p>Try to scroll this section and look at the navigation bar while scrolling! Try to scroll this section and look at the navigation bar while scrolling!</p>
                    <p>Try to scroll this section and look at the navigation bar while scrolling! Try to scroll this section and look at the navigation bar while scrolling!</p>
                </div>
                <div id="section3" class="container-fluid">
                    <h1>Section 3</h1>
                    <p><img src="https://i.imgur.com/UX64sfI.jpg"></p>
                    <p>Try to scroll this section and look at the navigation bar while scrolling! Try to scroll this section and look at the navigation bar while scrolling!</p>
                    <p>Try to scroll this section and look at the navigation bar while scrolling! Try to scroll this section and look at the navigation bar while scrolling!</p>
                </div>        
            </div>
        </div>
        
        <script>
            function change(element){
                element.nextElementSibling.classList.toggle('change');
            }

            window.onscroll = function() {myFunction()};
            var navbar = document.getElementById("upNav");
            var sticky = navbar.offsetTop;
            console.log('321');

            function myFunction() {
                if (window.pageYOffset >= sticky) {
                    navbar.classList.add("sticky")
                } else {
                    navbar.classList.remove("sticky");
                }
            }
        </script>    
    </body>
</html>